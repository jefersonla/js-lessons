<!DOCTYPE html>
<html>
<title>js-lessons</title>
<meta charset="utf-8">
<!-- Theses are just icons config - created with realfavicongenerator.net -->
<link rel="apple-touch-icon" sizes="57x57" href="assets/images/icons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="assets/images/icons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="assets/images/icons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="assets/images/icons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="assets/images/icons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="assets/images/icons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="assets/images/icons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="assets/images/icons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="assets/images/icons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="assets/images/icons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="assets/images/icons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="assets/images/icons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="assets/images/icons/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="assets/images/icons/manifest.json">
<link rel="mask-icon" href="assets/images/icons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="assets/images/icons/favicon.ico">
<meta name="msapplication-TileColor" content="#ffc40d">
<meta name="msapplication-TileImage" content="assets/images/icons/mstile-144x144.png">
<meta name="msapplication-config" content="assets/images/icons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<!-- These are just code mirror templates for editor -->
<link rel="stylesheet" href="assets/codemirror/theme/3024-day.css">
<link rel="stylesheet" href="assets/codemirror/theme/3024-night.css">
<link rel="stylesheet" href="assets/codemirror/theme/abcdef.css">
<link rel="stylesheet" href="assets/codemirror/theme/ambiance.css">
<link rel="stylesheet" href="assets/codemirror/theme/base16-dark.css">
<link rel="stylesheet" href="assets/codemirror/theme/bespin.css">
<link rel="stylesheet" href="assets/codemirror/theme/base16-light.css">
<link rel="stylesheet" href="assets/codemirror/theme/blackboard.css">
<link rel="stylesheet" href="assets/codemirror/theme/cobalt.css">
<link rel="stylesheet" href="assets/codemirror/theme/colorforth.css">
<link rel="stylesheet" href="assets/codemirror/theme/dracula.css">
<link rel="stylesheet" href="assets/codemirror/theme/eclipse.css">
<link rel="stylesheet" href="assets/codemirror/theme/elegant.css">
<link rel="stylesheet" href="assets/codemirror/theme/erlang-dark.css">
<link rel="stylesheet" href="assets/codemirror/theme/hopscotch.css">
<link rel="stylesheet" href="assets/codemirror/theme/icecoder.css">
<link rel="stylesheet" href="assets/codemirror/theme/isotope.css">
<link rel="stylesheet" href="assets/codemirror/theme/lesser-dark.css">
<link rel="stylesheet" href="assets/codemirror/theme/liquibyte.css">
<link rel="stylesheet" href="assets/codemirror/theme/material.css">
<link rel="stylesheet" href="assets/codemirror/theme/mbo.css">
<link rel="stylesheet" href="assets/codemirror/theme/mdn-like.css">
<link rel="stylesheet" href="assets/codemirror/theme/midnight.css">
<link rel="stylesheet" href="assets/codemirror/theme/monokai.css">
<link rel="stylesheet" href="assets/codemirror/theme/neat.css">
<link rel="stylesheet" href="assets/codemirror/theme/neo.css">
<link rel="stylesheet" href="assets/codemirror/theme/night.css">
<link rel="stylesheet" href="assets/codemirror/theme/paraiso-dark.css">
<link rel="stylesheet" href="assets/codemirror/theme/paraiso-light.css">
<link rel="stylesheet" href="assets/codemirror/theme/pastel-on-dark.css">
<link rel="stylesheet" href="assets/codemirror/theme/railscasts.css">
<link rel="stylesheet" href="assets/codemirror/theme/rubyblue.css">
<link rel="stylesheet" href="assets/codemirror/theme/seti.css">
<link rel="stylesheet" href="assets/codemirror/theme/solarized.css">
<link rel="stylesheet" href="assets/codemirror/theme/the-matrix.css">
<link rel="stylesheet" href="assets/codemirror/theme/tomorrow-night-bright.css">
<link rel="stylesheet" href="assets/codemirror/theme/tomorrow-night-eighties.css">
<link rel="stylesheet" href="assets/codemirror/theme/ttcn.css">
<link rel="stylesheet" href="assets/codemirror/theme/twilight.css">
<link rel="stylesheet" href="assets/codemirror/theme/vibrant-ink.css">
<link rel="stylesheet" href="assets/codemirror/theme/xq-dark.css">
<link rel="stylesheet" href="assets/codemirror/theme/xq-light.css">
<link rel="stylesheet" href="assets/codemirror/theme/yeti.css">
<link rel="stylesheet" href="assets/codemirror/theme/zenburn.css">
<!-- You can remove or leave at is -->
<!-- Stylesheets system - please don't remove :) -->
<link rel="stylesheet" href="assets/main.css">
<link rel="stylesheet" href="assets/codemirror/codemirror.css">
<link rel="stylesheet" href="assets/codemirror/addons/show-hint.css">
<link rel="stylesheet" href="assets/codemirror/addons/lint.css">
<link rel="stylesheet" href="assets/codemirror/addons/fullscreen.css">
<script type="text/javascript">
	// Adds the implementation for Array.prototype.concatAll()
	function defineConcatAll() {
		Array.prototype.concatAll = function () {
			var results = [];

			this.forEach(function(subArray) {
				results.push.apply(results, subArray);
			});

			return results;
		};
	}

	/**
	 * Add the implementation for Array.prototype.concatMap()
	 */
	function defineConcatMap() {
		Array.prototype.concatMap = function(fnc) {
			return this.
				map(function (e) {
					return fnc(e);
				}).
				// apply the concatAll function to flatten the two-dimensional array
				concatAll();
		};
	}

	/**
	 * This function will be executed at the begining of each verifier function
	 */
	function preVerifierHook() {
		// Add helpers to prevent 'undefined is not a function' like errors
		defineConcatAll();
		defineConcatMap();
	}

	function showLessonErrorMessage(exp, got, note, div){
		var preTag;
		var expected = JSON.stringify(JSON.parse(exp), undefined, 4);

		div.innerHTML = "<h4>Expected:</h4>";
		preTag = document.createElement("pre");
		preTag.innerHTML += expected;
		div.appendChild(preTag);
		div.innerHTML += "<h4>Got:</h4>";
		preTag = document.createElement("pre");
		preTag.innerHTML += got;
		div.appendChild(preTag);
		
		div.innerHTML += (note !== "") ? ("<h4>Note</h4><p style=\"margin-left: 25px;\">" + note + "</p>") : ""; 
		div.className = "info";
	}
</script>

<xmp theme="united" style="display:none;">
<div id="loader-wrapper">
	<div id="loader"></div>
	<div class="loader-section section-left"></div>
	<div class="loader-section section-right"></div>
</div>

# Welcome to js-lessons
### Interactive js exercises
---

## Preface

js-lessons is a framework of interactive exercises written in JS, for running in any (or at least in the new ones)
browser. If you wanna make a new set of exercises just make a fork of the repository stored in [js-lessons](https://github.com/jefersonla/js-lessons) and create your own JS set of exercises.

js-lessons is based on [learnrx](http://reactivex.io/learnrx/) functional programing exercise, available in 
[learnrx-repo](http://reactivex.io/learnrx/), it uses [underscore](http://underscorejs.org/) to make it eficient, and
is compatible with markdown and jekyll too. Ahh we use [my-json](http://myjson.com/) to store exercises too, but you can
remove this part if you don't want to.

### Finishing the Interactive Exercises 

js-lessons is not just a "tutorial", is much more than that, js-lessons is a **series of interactive exercises that you 
can fill out right in your browser!** dude! It's awesome just edit the code according to the question and hit "go",
if the code is working you can proceed to the next question, if don't the error will appear and you just need to
correct and hit go again, until the code works, nice uh!?

** Note 1: ** Use "F4" key to toggle full screen mode in editor, and press "ESC" or "F4" to leave this mode;

** Note 2: ** You can use "CTRL + SPACE" to active autocomplete; 

** Note 3: ** Every "console.log()", below each question will appear in output div;

** Note 4: ** We use jshint to check the syntax of your code, but you can disable this too;

** Note 5: ** You can choose the template of the page in version beta [js-lessons.BETA](beta.html), 
but you can choose the template of editors in this version.

** ! This exercise is just for test purpose, and documentation, so don't use it for real learning. **

### Personal Configurations

<p style="margin-bottom:0;"> <b> Select a theme for codeMirrorEditors </b><br>
<select style="margin-top: 5px;" onchange="selectTheme()" id="select">
    <option selected="">default</option>
    <option>3024-day</option>
    <option>3024-night</option>
    <option>abcdef</option>
    <option>ambiance</option>
    <option>base16-dark</option>
    <option>base16-light</option>
    <option>bespin</option>
    <option>blackboard</option>
    <option>cobalt</option>
    <option>colorforth</option>
    <option>dracula</option>
    <option>eclipse</option>
    <option>elegant</option>
    <option>erlang-dark</option>
    <option>hopscotch</option>
    <option>icecoder</option>
    <option>isotope</option>
    <option>lesser-dark</option>
    <option>liquibyte</option>
    <option>material</option>
    <option>mbo</option>
    <option>mdn-like</option>
    <option>midnight</option>
    <option>monokai</option>
    <option>neat</option>
    <option>neo</option>
    <option>night</option>
    <option>paraiso-dark</option>
    <option>paraiso-light</option>
    <option>pastel-on-dark</option>
    <option>railscasts</option>
    <option>rubyblue</option>
    <option>seti</option>
    <option>solarized dark</option>
    <option>solarized light</option>
    <option>the-matrix</option>
    <option>tomorrow-night-bright</option>
    <option>tomorrow-night-eighties</option>
    <option>ttcn</option>
    <option>twilight</option>
    <option>vibrant-ink</option>
    <option>xq-dark</option>
    <option>xq-light</option>
    <option>yeti</option>
    <option>zenburn</option>
</select>
</p><p style="margin-bottom:0;"> <b> Select a theme for this page </b><br>
<select style="margin-top: 5px;" onchange="selectThemePage()" id="selectpage">
    <option selected="">united</option>
    <option>amelia</option>
    <option>cerulean</option>
    <option>cyborg</option>
    <option>journal</option>
    <option>readable</option>
    <option>simplex</option>
    <option>slate</option>
    <option>spacelab</option>
    <option>spruce</option>
    <option>superhero</option>
</select>
</p><form>
<label> <b> Username </b> </label> <input type="text" name="fname"> <br>
<label> <b> Password </b> </label> <input type="password" name="fname">
</form>

## Introduction

The Array is Javascript's only collection type. Arrays are everywhere. We're going to add the five functions to the Array type, and in the process make it much more powerful and useful. As a matter of fact, Array already has the map, filter, and reduce functions! However we're going to reimplement these functions as a learning exercise.

This section will follow a pattern. First we'll solve problems the way you probably learned in school, or on your own by reading other people's code. In other words, we'll transform collections into new collections using loops and statements. Then we'll implement one of the five functions, and then use it to solve the same problem again *without* the loop. Once we've learned the five functions, you'll learn how to combine them to solve complex problems with very little code. The first two exercises have been completed in advance, but please look them over carefully!

## Chapter 1 - Traversing an Array
### Exercise 1
#### Print all the names in an array

<div class="lesson">
	<textarea class="code" rows="8" cols="80">
/*jshint esversion: 6 */
function(console) { // jshint ignore:line
	var names = ["Ben", "Jafar", "Matt", "Priya", "Brian"],
		counter;

	for(counter = 0; counter < names.length; counter++) {
		console.log(names[counter]);
	}
}
	</textarea>
	<div class="output"></div>
	<div class="output"></div>
	<pre id="" class="verifier">
		// Traverse array with for loop
		function(str, info) {
			preVerifierHook();
			var fun = eval("(" + str + ")");
			var items = [];
			var got;
			var expected = '["Ben","Brian","Jafar","Matt","Priya"]';
			fun({
				log:function(name) {
					items.push(name);
					console.log(name);
				}
			});

			got = JSON.stringify(items.sort());
			if(got === expected) {
				return "Success!"
			}
			else {
				showLessonErrorMessage(expected, JSON.stringify(items.sort(), undefined, 4), 'Order does not matter', info);
			}
		}
	</pre>
	<button class="go">Run</button>
</div>
<!-- ********************** START OF EXERCISE ********************** -->
<div style="display:none;" id="START-EXERCISE"></div>
<!-- ********************** LESSON 1 - BEGIN *********************** -->
<div style="display:none;" id="lessonB1"></div>

### Exercise 2
#### Use forEach to print all the names in an array

Let's repeat the previous exercise using the forEach function.

<div class="lesson">
	<textarea class="code" rows="8" cols="80">
/*jshint esversion: 6 */
function(console) { // jshint ignore:line
	var names = ["Ben", "Jafar", "Matt", "Priya", "Brian"];

	_.forEach(names, (el) => (console.log(el)));
}
	</textarea>
	<div class="output"></div>
	<div class="output"></div>
	<pre id="" class="verifier">
		// Traverse array with for loop
		function(str, info) {
			preVerifierHook();
			var fun = eval("(" + str + ")");
			var items = [];
			var got;
			var expected = '["Ben","Brian","Jafar","Matt","Priya"]';
			fun({
				log:function(name) {
					items.push(name);
					console.log(name);
				}
			});

			got = JSON.stringify(items.sort());
			if(got === expected) {
				return "Success!"
			}
			else {
				showLessonErrorMessage(expected, JSON.stringify(items.sort(), undefined, 4), 'Order does not matter', info);
			}
		}
	</pre>
	<button class="go">Run</button>
</div>
<div style="display:none;" id="lessonE1"></div> 
<!-- *********************** LESSON 1 - END *********************** -->
<!-- ********************** LESSON 2 - BEGIN ********************** -->
<div style="display:none;" id="lessonB2"></div> 

## Chapter 2
### Exercise 3
####  Project an array of videos into an array of {id,title} pairs using forEach()

Applying a function to a value and creating a new value is called a projection. To project one array into another, we apply a projection function to each item in the array and collect the results in a new array.

For each video, add a projected {id, title} pair to the videoAndTitlePairs array.

<div class="lesson">
	<textarea class="code" rows="60" cols="80">
/*jshint esversion: 6 */
function() { // jshint ignore:line
	var newReleases = [
		{
			"id": 70111470,
			"title": "Die Hard",
			"boxart": "http://cdn-0.nflximg.com/images/2891/DieHard.jpg",
			"uri": "http://api.netflix.com/catalog/titles/movies/70111470",
			"rating": [4.0],
			"bookmark": []
		},
		{
			"id": 654356453,
			"title": "Bad Boys",
			"boxart": "http://cdn-0.nflximg.com/images/2891/BadBoys.jpg",
			"uri": "http://api.netflix.com/catalog/titles/movies/70111470",
			"rating": [5.0],
			"bookmark": [{ id:432534, time:65876586 }]
		},
		{
			"id": 65432445,
			"title": "The Chamber",
			"boxart": "http://cdn-0.nflximg.com/images/2891/TheChamber.jpg",
			"uri": "http://api.netflix.com/catalog/titles/movies/70111470",
			"rating": [4.0],
			"bookmark": []
		},
		{
			"id": 675465,
			"title": "Fracture",
			"boxart": "http://cdn-0.nflximg.com/images/2891/Fracture.jpg",
			"uri": "http://api.netflix.com/catalog/titles/movies/70111470",
			"rating": [5.0],
			"bookmark": [{ id:432534, time:65876586 }]
		}
	],
	videoAndTitlePairs = [];

	// ------------ INSERT CODE HERE! -----------------------------------
	// Use forEach function to accumulate {id, title} pairs from each video.
	// Put the results into the videoAndTitlePairs array using the Array's
	// push() method. Example: videoAndTitlePairs.push(newItem);
	// ------------ INSERT CODE HERE! -----------------------------------


	return videoAndTitlePairs;
}
	</textarea>
	<div class="output"></div>
	<div class="output"></div>
	<pre class="verifier">
		// Projection with with forEach
		function(str, info) {
			preVerifierHook();
			var fun = eval("(" + str + ")"),
				videoAndTitlePairs = fun(),
				expected = '[{\"id\":675465,\"title\":\"Fracture\"},{\"id\":65432445,\"title\":\"The Chamber\"},{\"id\":70111470,\"title\":\"Die Hard\"},{\"id\":654356453,\"title\":\"Bad Boys\"}]';

			// Sorting by video id
			videoAndTitlePairs = _.sortBy(videoAndTitlePairs, function(video) { return video.id });
			if (JSON.stringify(videoAndTitlePairs) === expected) {
				return "YUPPPEEEE!";
			}
			else {
				showLessonErrorMessage(expected, JSON.stringify(videoAndTitlePairs, undefined, 4), "", info);
			}
		}
	</pre>
	<button class="go">Run</button>
</div>
<div style="display:none;" id="lessonE2"></div>
<!-- *********************** LESSON 2 - END *********************** -->
<!-- ********************** LESSON 1 - BEGIN *********************** -->
<div style="display:none;" id="lessonB3"></div>

## The end!
### Congratulations!!! :D

I hope you enjoyed use js-lessons as I enjoyed programming it!

Created By ** Jeferson Lima ** * a fan of penguins *.

</div>
<div style="display:none;" id="lessonE3"></div> 
<!-- *********************** LESSON 1 - END *********************** -->
<div style="display:none;" id="END-EXERCISE"></div>
<!-- ********************** END OF EXERCISE *********************** -->
</xmp>

<!-- Nice librarie for functional programming -->
<script type="text/javascript" src="assets/underscore/underscore-min.js"></script>

<!-- Since strapdown is stupid and can change the value of textarea, we need to make a backup of all code -->
<script type="text/javascript">
	/*
	(function() {
		var code;
		window.codeBackup = [];
		
		//while(document.getElementsByTagName("textarea") == 0){
			code = document.getElementsByTagName("textarea");	
			console.log(code);
			console.log("OXEE");
		//}

		_.each(code, (el) => {
			window.codeBackup.push({
				_el  : el,
				text : el.value
			});
		});
	})();
	*/

	/* Non functional */
	// Thanks StackOverflow!
	// http://stackoverflow.com/questions/1144783/replacing-all-occurrences-of-a-string-in-javascript
	replaceAll = function(search, replacement, object) {
	    return object.replace(new RegExp(search, 'g'), replacement);
	};
</script>

<!-- Libraries for interface -->
<script src="assets/strapdown/v/0.2/strapdown.js"></script>
<script src="assets/codemirror/codemirror.js"></script>
<!-- Some code mirrors addons -->
<script src="assets/codemirror/javascript.js"></script>
<script src="assets/codemirror/addons/matchbrackets.js"></script>
<script src="assets/codemirror/addons/autorefresh.js"></script>
<script src="assets/codemirror/addons/javascript-hint.js"></script>
<script src="assets/codemirror/addons/jshint.js"></script>
<script src="assets/codemirror/addons/javascript-lint.js"></script>
<script src="assets/codemirror/addons/lint.js"></script>
<script src="assets/codemirror/addons/show-hint.js"></script>
<script src="assets/codemirror/addons/fullscreen.js"></script>
<script src="assets/codemirror/addons/active-line.js"></script>

<!-- APP LIBRARIES --> 
<script src="assets/app/wordlist.js"></script>
<!-- <script src="assets/app/utils.js"></script> -->
<!-- <script src="assets/app/main.js"></script> -->

<script type="text/javascript">
	// Hide the remain exercises without remove markdown support
	// Remember to use functional paradigm :p
	(function (){
		var x = document.getElementById("START-EXERCISE");
		while(x.nextElementSibling.id != "END-EXERCISE"){
			x.style.display = "none";
			x = x.nextElementSibling;
		}

		x = document.getElementsByClassName("code");
		_.each(x, el => {
			el.value = el.value.replace(/(<a\ href=").*(">)/g, 		"");
			el.value = el.value.replace(new RegExp("</a>", 'g'), 	"");
			el.value = el.value.replace(new RegExp("<em>", 'g'), 	"*");
			el.value = el.value.replace(new RegExp("</em>", 'g'), 	"*");
		});
	})();

	/*(function (){
		var x = document.getElementsByClassName("go");
		
		// Just unhide to confirm this possibility
		_.each(x, function(el) {
			el.onclick = (ev) =>  {


				p = ev.target.parentElement.nextElementSibling;
				while(!p.id.startsWith("lessonB")){
					p = p.nextElementSibling;
				}

				p = p.nextElementSibling;
				while(!p.id.startsWith("lessonE")){
					p.style.display = "";
					p = p.nextElementSibling;
				}

				p.previousElementSibling.scrollIntoView();
			}
		}); 
	})();*/
	
	var codeMirrorEditors = [];
	var lessons = document.getElementsByClassName("lesson");

	function scrollTo(element, to, duration) {
	    var difference 	= (to + 60) - element.scrollTop;
	    var perTickSize = (difference / duration).toFixed();
	    var perTickTime = (duration / difference).toFixed(2);
	    var pageHeight	= window.innerHeight;

	    console.log("St = " + perTickSize + " | Ts = " + perTickTime + " | S = " + difference + " | D = " + duration);

	    var scrollingId = setInterval( _ => {
	    	if((duration <= 0) || ((pageHeight + element.scrollTop) > element.offsetHeight)){
	    		clearInterval(scrollingId);
	    		return;
	    	}
	    	console.log(element.scrollTop);
	    	duration -= perTickTime;
	    	element.scrollTop = element.scrollTop + perTickSize;
	    }, perTickTime);		
	}

	_.each(lessons, function (el){
		var code = el.children[0];
		var output = el.children[1];
		var info = el.children[2]; 
		var verifierScript = el.children[3].textContent;
		var go = el.children[4];

		code.style.visibility = null;
		code.style.display = null;

		CodeMirror.defaults.lint = true;

		var codeMirror = CodeMirror.fromTextArea(code, {
			    lineNumbers: true,
			    mode: "javascript",
			    gutters: ["CodeMirror-lint-markers"],
			    lint: true,
				matchBrackets: true,
				autoRefresh: true,
				tabSize: 4,
				//styleActiveLine: true,
				indentWithTabs: false,
				hint: true,
				extraKeys: {
					"F4": function(cm) {
						cm.setOption("fullScreen", !cm.getOption("fullScreen"));
					},
					"Esc": function(cm) {
						if (cm.getOption("fullScreen")) cm.setOption("fullScreen", false);
					},
					"Ctrl-Space": "autocomplete"
				}
			});

		codeMirrorEditors.push(codeMirror);

		configureReadOnlyLines(codeMirror);

		go.onclick = (ev) =>  {
			console.log("EVENT OK!");
			console.log(ev);
			try{
				var verificador = eval("(" + verifierScript + ")");
				output.textContent = verificador(codeMirror.getValue(), info, el);
			} catch (ex) {
				alert(ex);
			}

			if((output.textContent !== "Success!") && (output.textContent !== "YUPPPEEEE!")){
				output.className = "error";
				output.textContent = "Error!";
				return;
			}

			output.className = "success";
			info.className = "output";

			var p = ev.target.parentElement.nextElementSibling;
			while(!p.id.startsWith("lessonB")){
				p = p.nextElementSibling;
			}

			p = p.nextElementSibling;
			while(!p.id.startsWith("lessonE")){
				p.style.display = "";
				p = p.nextElementSibling;
			}		

			//scrollTo(document.body, output.offsetTop, 600);
		};

		// Since text area only have javascript code, is not necessary left "<a href"
	});

	var input = document.getElementById("select");
	function selectTheme() {
		var theme = input.options[input.selectedIndex].textContent;
		_.each(codeMirrorEditors, el => {
			el.setOption("theme", theme)
		});
		location.hash = "#" + theme;
	}
	var choice = (location.hash && location.hash.slice(1)) ||
	             (document.location.search &&
	             decodeURIComponent(document.location.search.slice(1)));
	if (choice) {
		input.value = choice;
		_.each(codeMirrorEditors, el => {
			el.setOption("theme", choice)
		});
	}
	CodeMirror.on(window, "hashchange", function() {
		var theme = location.hash.slice(1);
		if (theme) {
			input.value = theme; selectTheme();
		}
	});

	// After all page got rendered remove loader
	document.body.classList.add("loaded");

	/**
	 * This function assumes that lines containing three consecutive
	 * slahes (---) are markers to delimit read-only text.
	 * If a marker exists, then all lines not between consecutive markers
	 * become read-only.
	 * Example:
	 * <textarea>
	 *   This line is read-only
	 *   ---
	 *   This line is read-write
	 *   ---
	 *   This line is also read-only
	 * </textarea>
	 */
	function configureReadOnlyLines(codeMirrorEditor) {
		var i,
			doc = codeMirrorEditor.doc,
			lines = doc.children[0].lines.map(line => line.text);
			separatorIndices = _.range(lines.length).filter(idx => lines[idx].indexOf("---") != -1);

		if (separatorIndices.length > 0) {
			separatorIndices = [0].concat(separatorIndices, lines.length - 1);
			for (i = 0; i < separatorIndices.length - 1; i += 2) {
				doc.markText({line: separatorIndices[i], ch: 0},
					{line: separatorIndices[i + 1] + 1, ch: 0},
					{readOnly: true, css: "opacity: 0.6"});
			}
		}
	}

</script>

</html>
<!-- TODO
	+ Remember to use jekyll, I think it's a good idea for clean the code
	+ USE http://myjson.com/api to store JSON with progress of each student
	+ USE https://ihatetomatoes.net/create-custom-preloading-screen/ while markdown is parsed and content are hidding
-->